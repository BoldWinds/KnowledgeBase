---
DOI: [https://doi.org/10.1002/jcc.21334]
Description: AutoDock Vina
Publication Year: 2010
Rating: ⭐⭐⭐⭐
Status: Done
Tag: Vina
---
# Intro

- **定义**：高效地预测大分子之间（更常见的是大分子即受体与小分子即配体）的（非共价键）结合情况。
- **目标**：一是预测结合后的构象，二是预测结合亲和力

# 方法

- 分子动力学结合显示溶剂（molecular dynamics with explicit solvent）：把溶剂分子明确地表示出来参与运算，牺牲运算速度换精细度
- 分子动力学与分子力学结合隐式溶剂（molecular dynamics and molecular mechanics with implicit solvent）：不会计算每一个溶剂分子
- 分子对接（molecular docking）：侧重于快速地去搜索可能的结合构象、预测结合情况

分子动力学试图精确计算体系中的各种能量；而分子对接的关注点在于重建化学势

# 假设

不管用何种方法，都假设分子有着特定的质子化状态以及电荷分布，并且假定这些在分子的结合态与未结合态之间是不会发生改变的

除此以外，分子对接还会假定受体大部分是==刚性==的，并且会选定一组共价键，将其视作是可以自由旋转的来简化计算

# scoring function

尝试==估计==系统标准化学势的方法。由于是估计的方法，计算方法应该不会很优美？文中提到了其大量使用经验性加权。

既然是以人的经验来对化学势进行估计打分，那么用机器学习可能也可以，文章中就会采用类似机器学习的方法

## 方法

### 方法背景

scoring function中的构象相关部分的函数：

$$  
c=\sum_{i<j}f_{t_it_j}(r_{ij})  
$$
- $r_{ij}$：原子对中两个原子i,j的距离
- $t_i$：原子的类型  
- $f$：用以表示相互作用的函数

实际上$c$是对诸多对可以相对移动的原子对计算他们相互作用的和。除此以外，$c$也可以被看作由分子外和分子内两部分的和
$$  
c=c_{inter}+c_{intra}  
$$

对于计算得到的$c$的值，我们会筛选出来最低的和其他比较低的得分构象

结合自由能是从最低的$c$中的分子间部分（$c_{inter}$）计算得出的，设最低得分为$c_1$，则有：
$$  
s_1=g(c_1-c_{intra1})=g(c_{inter1})  
$$
其他比较低的$c$也可以用来计算$c$ ，只不过这时使用同样的分子内贡献的值来计算：
$$  
s_i=g(c_i-c_{intra1})  
$$
> 关于为什么要用$c_{intra1}$而非$c_{intrai}$：
> 
> 统一使用最低得分构象，使得在计算结合自由能s时更注重于比较不同构象之间的分子间贡献的差异

## Vina的scoring function

- 综合考虑分子间和分子内贡献，因为忽略内部贡献可能会找到内部非常不合理的构象
- 结合了基于知识的势能和基于实证的经验
- 氢原子不考虑
- 原子类型的分类方式与X-Score一致

$f$的计算方式如下，其相当于用分子表面距离$d_{ij}$替代了$r_{ij}$。$d_{ij}=r_{ij}-R_{t_i}-R_{t_j}$,其中$R_t$是原子$t$的范德华半径
$$  
f_{t_it_j(r_{ij})}\equiv h_{t_it_j}(d_{ij})  
$$

h是以下4项的加权和：
- 空间相互作用(steric terms)，包括gauss_1，gauss_2和repulsion的加权和
- 所有原子对之间相同的空间相互作用
- 疏水原子之间的疏水相互作用(hydrophobic term)
- 在适用情况下的氢键(hydrogen bonding term)

|Weight|Term|
|---|---|
|-0.0356|gauss1|
|-0.00516|gauss2|
|0.840|Repulsion|
|-0.587|Hydrophobic|
|-0.0351|Hydrogen bonding|
|0.0585|Nrot|

$$  
s=g(c_{inter}=\frac{c_{inter}}{1+wN_{rot}})  
$$
待解决的疑问：
1. h的计算方法没有明确给出，但应该是文中提到的函数乘上权重再加和？
2. 求出h即代表能求出f和c，但是分子间和分子内的c怎么求不是很清楚

### 优化

迭代局部搜索全局优化器：
- 采取了一系列由变异和局部优化组成的步骤，并且每一步都根据 Metropolis 准则来接受
- 具体实现中采用BFGS算法进行局部优化。BFGS的目的是让优化算法朝着让评分函数值更低的方向搜索，使得收敛更快，得到局部最优值
- 从多个随机值开始，维护一组找到的最小值（局部最优），最后得到全局最优

### Result

从实验测定的结合配体结构开始，并创建一个与坐标系对齐的最小长方体来包含它

2埃的均方根偏差（RMSD）截断值通常被用作正确结合结构预测的标准